//create relationships from CVE to CPE
MATCH (n)-[r:AFFECTS]->() DELETE r

// jdbc driver must be loaded in the plugins folder for THIS neo4j database installation
call apoc.load.driver('oracle.jdbc.driver.OracleDriver')

CALL apoc.periodic.iterate(
'MATCH (x:nvdCve),(n:nvdCpe), (c:cpe) WHERE x.cve_id = n.cve_id and n.cpe_id = c.cpe_id RETURN x,c',
'MERGE (x)-[:AFFECTS]->(c)',
{batchSize:1000, parallel:true}
)
YIELD batches, total
RETURN batches, total